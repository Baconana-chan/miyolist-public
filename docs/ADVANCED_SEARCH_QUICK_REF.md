# Advanced Search - Quick Reference

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
1. **`lib/core/models/search_filters.dart`** - –ú–æ–¥–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ–∏—Å–∫–∞
2. **`lib/core/services/search_history_service.dart`** - –°–µ—Ä–≤–∏—Å –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞
3. **`lib/features/search/presentation/widgets/advanced_search_filters_dialog.dart`** - UI –¥–∏–∞–ª–æ–≥ —Ñ–∏–ª—å—Ç—Ä–æ–≤
4. **`docs/ADVANCED_SEARCH.md`** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
1. **`lib/core/services/anilist_service.dart`** - –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `advancedSearch()`
2. **`docs/TODO.md`** - –û—Ç–º–µ—á–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### –§–∏–ª—å—Ç—Ä—ã
- **–ñ–∞–Ω—Ä—ã** (–º—É–ª—å—Ç–∏–≤—ã–±–æ—Ä): 18 –∂–∞–Ω—Ä–æ–≤
- **–ì–æ–¥**: –°–ª–∞–π–¥–µ—Ä –æ—Ç 1940 –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞ + 1
- **–°–µ–∑–æ–Ω** (—Ç–æ–ª—å–∫–æ –∞–Ω–∏–º–µ): Winter, Spring, Summer, Fall
- **–§–æ—Ä–º–∞—Ç**: TV, Movie, Manga, Novel –∏ —Ç.–¥.
- **–°—Ç–∞—Ç—É—Å**: Finished, Releasing, Not Yet Released, Cancelled, Hiatus
- **–û—Ü–µ–Ω–∫–∞**: –î–∏–∞–ø–∞–∑–æ–Ω –æ—Ç 0 –¥–æ 100
- **–≠–ø–∏–∑–æ–¥—ã/–ì–ª–∞–≤—ã**: –ú–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º

#### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- –ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ü–æ –æ—Ü–µ–Ω–∫–µ
- –¢—Ä–µ–Ω–¥—ã
- –ê–ª—Ñ–∞–≤–∏—Ç
- –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞

#### –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 20 –∑–∞–ø—Ä–æ—Å–æ–≤
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —á–∏–ø—Å—ã
- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Hive

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

```dart
// –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –∞–Ω–∏–º–µ 2023 –≥–æ–¥–∞ —Å –∂–∞–Ω—Ä–æ–º Action
final results = await anilistService.advancedSearch(
  query: '',
  type: 'ANIME',
  genres: ['Action'],
  year: 2023,
  sortBy: 'SCORE_DESC',
);

// –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∏—Å–∫ –≤—ã—Å–æ–∫–æ—Ä–µ–π—Ç–∏–Ω–≥–æ–≤–æ–π –º–∞–Ω–≥–∏
final results = await anilistService.advancedSearch(
  query: 'one piece',
  type: 'MANGA',
  scoreMin: 80,
  sortBy: 'POPULARITY_DESC',
);
```

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (All, Anime, Manga, Character, Staff, Studio)
3. –í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
4. –ù–∞–∂–º–∏—Ç–µ "Advanced Filters" –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ª–æ–≥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
5. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
   - –ñ–∞–Ω—Ä—ã (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)
   - –ì–æ–¥ (—Å–ª–∞–π–¥–µ—Ä)
   - –°–µ–∑–æ–Ω (–¥–ª—è –∞–Ω–∏–º–µ)
   - –§–æ—Ä–º–∞—Ç
   - –°—Ç–∞—Ç—É—Å
   - –î–∏–∞–ø–∞–∑–æ–Ω –æ—Ü–µ–Ω–æ–∫
   - –î–∏–∞–ø–∞–∑–æ–Ω —ç–ø–∏–∑–æ–¥–æ–≤/–≥–ª–∞–≤
6. –ù–∞–∂–º–∏—Ç–µ "Apply Filters"
7. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ AppBar –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞
8. –ù–∞–∂–º–∏—Ç–µ "Search"

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GlobalSearchPage
–§–∞–π–ª `global_search_page.dart` –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:

1. –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã:
   ```dart
   import '../../../../core/models/search_filters.dart';
   import '../../../../core/services/search_history_service.dart';
   import '../widgets/advanced_search_filters_dialog.dart';
   ```

2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
   ```dart
   SearchFilters _filters = SearchFilters();
   SearchHistoryService _searchHistory = SearchHistoryService();
   List<String> _recentSearches = [];
   ```

3. –ó–∞–º–µ–Ω–∏—Ç—å `_performSearch()` –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `advancedSearch()`

4. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "Advanced Filters"

5. –î–æ–±–∞–≤–∏—Ç—å –º–µ–Ω—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

6. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
lib/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ search_filters.dart          (NEW)
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ anilist_service.dart         (UPDATED)
‚îÇ       ‚îî‚îÄ‚îÄ search_history_service.dart  (NEW)
‚îî‚îÄ‚îÄ features/
    ‚îî‚îÄ‚îÄ search/
        ‚îî‚îÄ‚îÄ presentation/
            ‚îú‚îÄ‚îÄ pages/
            ‚îÇ   ‚îî‚îÄ‚îÄ global_search_page.dart    (TO UPDATE)
            ‚îî‚îÄ‚îÄ widgets/
                ‚îî‚îÄ‚îÄ advanced_search_filters_dialog.dart  (NEW)
```

## GraphQL Query

–ú–µ—Ç–æ–¥ `advancedSearch()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π GraphQL –∑–∞–ø—Ä–æ—Å:

```graphql
query(
  $search: String,
  $type: MediaType,
  $genre_in: [String],
  $seasonYear: Int,
  $season: MediaSeason,
  $format: MediaFormat,
  $status: MediaStatus,
  $averageScore_greater: Int,
  $averageScore_lesser: Int,
  $episodes_greater: Int,
  $episodes_lesser: Int,
  $chapters_greater: Int,
  $chapters_lesser: Int,
  $sort: [MediaSort]
) {
  Page(perPage: 50) {
    media(...) {
      # –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–¥–∏–∞
    }
  }
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. ‚úÖ –ü–æ–∏—Å–∫ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤
2. ‚úÖ –ü–æ–∏—Å–∫ —Å –æ–¥–Ω–∏–º –∂–∞–Ω—Ä–æ–º
3. ‚úÖ –ü–æ–∏—Å–∫ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∂–∞–Ω—Ä–∞–º–∏
4. ‚úÖ –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –≥–æ–¥–∞
5. ‚úÖ –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º —Å–µ–∑–æ–Ω–∞
6. ‚úÖ –ü–æ–∏—Å–∫ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –æ—Ü–µ–Ω–æ–∫
7. ‚úÖ –ü–æ–∏—Å–∫ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º —ç–ø–∏–∑–æ–¥–æ–≤
8. ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
9. ‚úÖ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
10. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞/–æ—á–∏—Å—Ç–∫–∞)

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. –ú–∞–∫—Å–∏–º—É–º 50 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ AniList API)
2. –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ 20 –∑–∞–ø–∏—Å—è–º–∏
3. –§–∏–ª—å—Ç—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è Character, Staff, Studio (–æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–º.:
- [ADVANCED_SEARCH.md](./ADVANCED_SEARCH.md) - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [TODO.md](./TODO.md) - –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–π
